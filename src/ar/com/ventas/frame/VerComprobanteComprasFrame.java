/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ar.com.ventas.frame;

import ar.com.ventas.entities.ComprobanteCompras;
import ar.com.ventas.entities.ComprobanteComprasDetalle;
import ar.com.ventas.entities.Configuracion;
import ar.com.ventas.entities.CuentaCorrienteProveedor;
import ar.com.ventas.entities.Periodo;
import ar.com.ventas.entities.Proveedor;
import ar.com.ventas.services.ComprobanteComprasDetalleService;
import ar.com.ventas.services.ConfiguracionService;
import ar.com.ventas.services.CuentaCorrienteProveedorService;
import ar.com.ventas.services.PeriodoService;
import java.awt.Color;
import java.awt.Font;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.print.PageFormat;
import java.awt.print.Paper;
import java.awt.print.Printable;
import static java.awt.print.Printable.NO_SUCH_PAGE;
import static java.awt.print.Printable.PAGE_EXISTS;
import java.awt.print.PrinterException;
import java.awt.print.PrinterJob;
import java.util.Date;
import java.text.DecimalFormat;
import java.text.SimpleDateFormat;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;

/**
 *
 * @author Administrador
 */
public class VerComprobanteComprasFrame extends javax.swing.JFrame {

    private String filtro;
    private List<Periodo> periodos = null;
    private List<Proveedor> proveedores = null;
    private Proveedor proveedorSeleccionado = null;
    private Integer codigoProveedor;
    private float iva = 0;
    private Configuracion conf = null;
    private Double gravado;
    private Double noGravado;
    private Double impuestoInterno;
    private Double percepcionIIBB;
    private Double percepcionIva;
    private Double importeIva;
    private Double otro;
    private Double importeTotal;
    private DecimalFormat df = new DecimalFormat("#0.00");
    private ComprobanteCompras comprobante;
    private ComprobanteCompras exComprobante;
    private CuentaCorrienteProveedor cuentaProveedor;
    private SimpleDateFormat sdf = new SimpleDateFormat("dd/MM/yyyy");
    private Integer row1 = 0;
    private Date fd1 = new Date();
    private Date fa1 = new Date();

    /**
     * Creates new form Modificar Iva Compras
     *
     * @param comprobante
     * @param df
     * @param af
     * @param row
     */
    public VerComprobanteComprasFrame(ComprobanteCompras comprobante, Date df, Date af, Integer row) {
        getContentPane().setBackground(new java.awt.Color(245, 222, 179));
        initComponents();
        this.row1 = row;
        this.fa1 = af;
        this.fd1 = df;
        this.comprobante = comprobante;
        this.exComprobante = comprobante;
        cargarConfiguracion();
        llenarCampos();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        volverBtn = new javax.swing.JButton();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        jLabel7 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        jLabel9 = new javax.swing.JLabel();
        jLabel10 = new javax.swing.JLabel();
        jLabel11 = new javax.swing.JLabel();
        nroSucursalTxt = new javax.swing.JTextField();
        nroFacturTxt = new javax.swing.JTextField();
        jLabel13 = new javax.swing.JLabel();
        fechaFacturaTxt = new javax.swing.JTextField();
        comboLetraFactura = new javax.swing.JComboBox();
        gravadoTxt = new javax.swing.JTextField();
        impuestoInternoTxt = new javax.swing.JTextField();
        percepcionIIBBTxt = new javax.swing.JTextField();
        percepcionIvaTxt = new javax.swing.JTextField();
        otroTxt = new javax.swing.JTextField();
        ivaTxt = new javax.swing.JTextField();
        totalTxt = new javax.swing.JTextField();
        jLabel4 = new javax.swing.JLabel();
        razonSocialProveedorBuscadoTxt = new javax.swing.JTextField();
        codigoProveedorTxt = new javax.swing.JTextField();
        jLabel14 = new javax.swing.JLabel();
        noGravadoTxt = new javax.swing.JTextField();
        facturaChk = new javax.swing.JRadioButton();
        notaCreditoChk = new javax.swing.JRadioButton();
        comboPeriodos = new javax.swing.JComboBox<>();
        notaDebitoChk = new javax.swing.JRadioButton();
        llevaDetalleChk = new javax.swing.JCheckBox();
        detalle1Txt = new javax.swing.JTextField();
        detalle2Txt = new javax.swing.JTextField();
        detalle3Txt = new javax.swing.JTextField();
        detalle4Txt = new javax.swing.JTextField();
        impresionBtn = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.DO_NOTHING_ON_CLOSE);
        setTitle("VISUALIZAR COMPROBANTE COMPRAS");

        volverBtn.setText("Volver");
        volverBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                volverBtnActionPerformed(evt);
            }
        });

        jLabel1.setText("Fecha Periodo:");

        jLabel2.setText("Letra y NÃºmero:");

        jLabel3.setText("Codigo Proveedor:");

        jLabel5.setText("Gravado:");

        jLabel6.setText("Imp. Interno:");

        jLabel7.setText("Percep.II BB:");

        jLabel8.setText("Percep. IVA:");

        jLabel9.setText("Otro:");

        jLabel10.setText("IVA:");

        jLabel11.setText("Total:");

        nroSucursalTxt.setText("Nro Sucursal");
        nroSucursalTxt.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                nroSucursalTxtKeyPressed(evt);
            }
        });

        nroFacturTxt.setText("Nro Factura");
        nroFacturTxt.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                nroFacturTxtKeyPressed(evt);
            }
        });

        jLabel13.setText("Fecha Factura:");

        fechaFacturaTxt.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        fechaFacturaTxt.setText("FECHA FACTURA");
        fechaFacturaTxt.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                fechaFacturaTxtKeyPressed(evt);
            }
        });

        comboLetraFactura.setModel(new javax.swing.DefaultComboBoxModel(new String[] { " ", "A", "C", "M", "B", "X" }));
        comboLetraFactura.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                comboLetraFacturaActionPerformed(evt);
            }
        });
        comboLetraFactura.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                comboLetraFacturaKeyPressed(evt);
            }
        });

        gravadoTxt.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        gravadoTxt.setText("GRAVADO");
        gravadoTxt.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                gravadoTxtKeyPressed(evt);
            }
        });

        impuestoInternoTxt.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        impuestoInternoTxt.setText("IMP.INTERNO");
        impuestoInternoTxt.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                impuestoInternoTxtKeyPressed(evt);
            }
        });

        percepcionIIBBTxt.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        percepcionIIBBTxt.setText("PERC.II BB");
        percepcionIIBBTxt.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                percepcionIIBBTxtKeyPressed(evt);
            }
        });

        percepcionIvaTxt.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        percepcionIvaTxt.setText("PERCEP IVA");
        percepcionIvaTxt.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                percepcionIvaTxtKeyPressed(evt);
            }
        });

        otroTxt.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        otroTxt.setText("OTRO");
        otroTxt.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                otroTxtKeyPressed(evt);
            }
        });

        ivaTxt.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        ivaTxt.setText("IVA");
        ivaTxt.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                ivaTxtKeyPressed(evt);
            }
        });

        totalTxt.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        totalTxt.setText("TOTAL");
        totalTxt.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                totalTxtKeyPressed(evt);
            }
        });

        jLabel4.setText("Proveedor:");

        razonSocialProveedorBuscadoTxt.setText("RAZON SOCIAL PROVEEDOR");

        codigoProveedorTxt.setText("CODIGO PROVEEDOR");
        codigoProveedorTxt.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                codigoProveedorTxtKeyPressed(evt);
            }
        });

        jLabel14.setText("No Gravado:");

        noGravadoTxt.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        noGravadoTxt.setText("NO GRAVADO");
        noGravadoTxt.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                noGravadoTxtKeyPressed(evt);
            }
        });

        facturaChk.setText("Factura");
        facturaChk.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                facturaChkActionPerformed(evt);
            }
        });

        notaCreditoChk.setText("Nota CrÃ©dito");
        notaCreditoChk.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                notaCreditoChkActionPerformed(evt);
            }
        });

        comboPeriodos.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        comboPeriodos.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                comboPeriodosKeyPressed(evt);
            }
        });

        notaDebitoChk.setText("Nota de DÃ©bito");
        notaDebitoChk.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                notaDebitoChkActionPerformed(evt);
            }
        });

        llevaDetalleChk.setText("Lleva Detalle");

        detalle1Txt.setText("DETALLE 1");

        detalle2Txt.setText("DETALLE 2");

        detalle3Txt.setText("DETALLE 3");

        detalle4Txt.setText("DETALLE 4");

        impresionBtn.setText("Impresion");
        impresionBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                impresionBtnActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                    .addComponent(jLabel3)
                                    .addComponent(jLabel5)
                                    .addGroup(layout.createSequentialGroup()
                                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                            .addComponent(jLabel8)
                                            .addComponent(jLabel7)
                                            .addComponent(jLabel9)
                                            .addComponent(jLabel10)
                                            .addComponent(jLabel11))
                                        .addGap(1, 1, 1))
                                    .addComponent(jLabel14))
                                .addComponent(jLabel6, javax.swing.GroupLayout.Alignment.TRAILING))
                            .addComponent(jLabel4))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                .addComponent(llevaDetalleChk)
                                .addGroup(layout.createSequentialGroup()
                                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                        .addComponent(codigoProveedorTxt, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.PREFERRED_SIZE, 134, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(razonSocialProveedorBuscadoTxt, javax.swing.GroupLayout.PREFERRED_SIZE, 255, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(facturaChk))
                                    .addGap(10, 10, 10)
                                    .addComponent(notaCreditoChk)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                    .addComponent(notaDebitoChk)))
                            .addComponent(percepcionIIBBTxt, javax.swing.GroupLayout.PREFERRED_SIZE, 89, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(gravadoTxt, javax.swing.GroupLayout.PREFERRED_SIZE, 102, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(layout.createSequentialGroup()
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                                    .addComponent(totalTxt, javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(ivaTxt, javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(noGravadoTxt, javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(otroTxt, javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(percepcionIvaTxt, javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(impuestoInternoTxt, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 106, Short.MAX_VALUE))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 511, Short.MAX_VALUE)
                                .addComponent(volverBtn))))
                    .addGroup(layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                            .addGroup(javax.swing.GroupLayout.Alignment.LEADING, layout.createSequentialGroup()
                                .addComponent(jLabel1)
                                .addGap(18, 18, 18)
                                .addComponent(comboPeriodos, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                            .addGroup(javax.swing.GroupLayout.Alignment.LEADING, layout.createSequentialGroup()
                                .addComponent(jLabel13)
                                .addGap(18, 18, 18)
                                .addComponent(fechaFacturaTxt, javax.swing.GroupLayout.PREFERRED_SIZE, 153, javax.swing.GroupLayout.PREFERRED_SIZE)))
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jLabel2)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(comboLetraFactura, javax.swing.GroupLayout.PREFERRED_SIZE, 64, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(nroSucursalTxt, javax.swing.GroupLayout.PREFERRED_SIZE, 87, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(detalle1Txt)
                            .addComponent(detalle2Txt)
                            .addComponent(detalle3Txt)
                            .addComponent(detalle4Txt)
                            .addGroup(layout.createSequentialGroup()
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(impresionBtn)
                                    .addComponent(nroFacturTxt, javax.swing.GroupLayout.PREFERRED_SIZE, 163, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(0, 0, Short.MAX_VALUE)))))
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel3)
                    .addComponent(codigoProveedorTxt, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(razonSocialProveedorBuscadoTxt, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel4))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel1)
                    .addComponent(comboPeriodos, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel13)
                    .addComponent(fechaFacturaTxt, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(facturaChk)
                    .addComponent(notaCreditoChk)
                    .addComponent(notaDebitoChk))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel2)
                    .addComponent(comboLetraFactura, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(nroSucursalTxt, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(nroFacturTxt, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(llevaDetalleChk))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel5)
                    .addComponent(gravadoTxt, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(detalle1Txt, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel14)
                    .addComponent(noGravadoTxt, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(detalle2Txt, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(impuestoInternoTxt, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel6)
                    .addComponent(detalle3Txt, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel7)
                    .addComponent(percepcionIIBBTxt, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(detalle4Txt, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel8)
                    .addComponent(percepcionIvaTxt, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel9)
                    .addComponent(otroTxt, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel10)
                    .addComponent(ivaTxt, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel11)
                    .addComponent(totalTxt, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(volverBtn)
                    .addComponent(impresionBtn))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void volverBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_volverBtnActionPerformed
        AbmComprobantesCompraFrame av = new AbmComprobantesCompraFrame(fd1, fa1, row1);
        av.setVisible(true);
        this.dispose();
    }//GEN-LAST:event_volverBtnActionPerformed

    private void comboLetraFacturaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_comboLetraFacturaActionPerformed

    }//GEN-LAST:event_comboLetraFacturaActionPerformed

    private void codigoProveedorTxtKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_codigoProveedorTxtKeyPressed

    }//GEN-LAST:event_codigoProveedorTxtKeyPressed

    private void facturaChkActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_facturaChkActionPerformed

    }//GEN-LAST:event_facturaChkActionPerformed

    private void notaCreditoChkActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_notaCreditoChkActionPerformed

    }//GEN-LAST:event_notaCreditoChkActionPerformed

    private void fechaFacturaTxtKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_fechaFacturaTxtKeyPressed

    }//GEN-LAST:event_fechaFacturaTxtKeyPressed

    private void comboLetraFacturaKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_comboLetraFacturaKeyPressed

    }//GEN-LAST:event_comboLetraFacturaKeyPressed

    private void nroSucursalTxtKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_nroSucursalTxtKeyPressed

    }//GEN-LAST:event_nroSucursalTxtKeyPressed

    private void nroFacturTxtKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_nroFacturTxtKeyPressed

    }//GEN-LAST:event_nroFacturTxtKeyPressed

    private void gravadoTxtKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_gravadoTxtKeyPressed

    }//GEN-LAST:event_gravadoTxtKeyPressed

    private void noGravadoTxtKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_noGravadoTxtKeyPressed

    }//GEN-LAST:event_noGravadoTxtKeyPressed

    private void otroTxtKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_otroTxtKeyPressed

    }//GEN-LAST:event_otroTxtKeyPressed

    private void impuestoInternoTxtKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_impuestoInternoTxtKeyPressed

    }//GEN-LAST:event_impuestoInternoTxtKeyPressed

    private void percepcionIIBBTxtKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_percepcionIIBBTxtKeyPressed

    }//GEN-LAST:event_percepcionIIBBTxtKeyPressed

    private void percepcionIvaTxtKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_percepcionIvaTxtKeyPressed

    }//GEN-LAST:event_percepcionIvaTxtKeyPressed

    private void totalTxtKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_totalTxtKeyPressed

    }//GEN-LAST:event_totalTxtKeyPressed

    private void ivaTxtKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_ivaTxtKeyPressed

    }//GEN-LAST:event_ivaTxtKeyPressed

    private void comboPeriodosKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_comboPeriodosKeyPressed

    }//GEN-LAST:event_comboPeriodosKeyPressed

    private void notaDebitoChkActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_notaDebitoChkActionPerformed

    }//GEN-LAST:event_notaDebitoChkActionPerformed

    private void impresionBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_impresionBtnActionPerformed
        impresion();
    }//GEN-LAST:event_impresionBtnActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(VerComprobanteComprasFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(VerComprobanteComprasFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(VerComprobanteComprasFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(VerComprobanteComprasFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new VerComprobanteComprasFrame(null, null, null, 0).setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTextField codigoProveedorTxt;
    private javax.swing.JComboBox comboLetraFactura;
    private javax.swing.JComboBox<String> comboPeriodos;
    private javax.swing.JTextField detalle1Txt;
    private javax.swing.JTextField detalle2Txt;
    private javax.swing.JTextField detalle3Txt;
    private javax.swing.JTextField detalle4Txt;
    private javax.swing.JRadioButton facturaChk;
    private javax.swing.JTextField fechaFacturaTxt;
    private javax.swing.JTextField gravadoTxt;
    private javax.swing.JButton impresionBtn;
    private javax.swing.JTextField impuestoInternoTxt;
    private javax.swing.JTextField ivaTxt;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JCheckBox llevaDetalleChk;
    private javax.swing.JTextField noGravadoTxt;
    private javax.swing.JRadioButton notaCreditoChk;
    private javax.swing.JRadioButton notaDebitoChk;
    private javax.swing.JTextField nroFacturTxt;
    private javax.swing.JTextField nroSucursalTxt;
    private javax.swing.JTextField otroTxt;
    private javax.swing.JTextField percepcionIIBBTxt;
    private javax.swing.JTextField percepcionIvaTxt;
    private javax.swing.JTextField razonSocialProveedorBuscadoTxt;
    private javax.swing.JTextField totalTxt;
    private javax.swing.JButton volverBtn;
    // End of variables declaration//GEN-END:variables

    private void cargarConfiguracion() {
        try {
            conf = new ConfiguracionService().getFacturas(1L);
        } catch (Exception ex) {
            Logger.getLogger(VerComprobanteComprasFrame.class.getName()).log(Level.SEVERE, null, ex);
        }
        iva = conf.getIva();
        try {
            periodos = new PeriodoService().getAllPeriodosAbiertos();
        } catch (Exception ex) {
            Logger.getLogger(VerComprobanteComprasFrame.class.getName()).log(Level.SEVERE, null, ex);
        }
        comboPeriodos.removeAllItems();
        comboPeriodos.addItem("");
        if (periodos != null && !periodos.isEmpty()) {
            for (Periodo p : periodos) {
                comboPeriodos.addItem(p.getDetalle());
            }
        }
    }

    private void llenarCampos() {
        proveedorSeleccionado = comprobante.getProveedor();
        try {
            cuentaProveedor = new CuentaCorrienteProveedorService().getCtaCteByComprobante(comprobante);
        } catch (Exception ex) {
            Logger.getLogger(VerComprobanteComprasFrame.class.getName()).log(Level.SEVERE, null, ex);
        }
        codigoProveedorTxt.setText(String.valueOf(proveedorSeleccionado.getCodigo()));
        razonSocialProveedorBuscadoTxt.setText(proveedorSeleccionado.getRazonSocial());
        codigoProveedorTxt.setEditable(false);
        razonSocialProveedorBuscadoTxt.setEditable(false);
        fechaFacturaTxt.setEditable(false);
        detalle1Txt.setText("");
        detalle2Txt.setText("");
        detalle3Txt.setText("");
        detalle4Txt.setText("");
        nroSucursalTxt.setEditable(false);
        nroFacturTxt.setEditable(false);
        comboPeriodos.setEditable(false);
        comboLetraFactura.setEditable(false);
        Date da = comprobante.getFechaPeriodo();
        int perio = 1;
        for (Periodo p : periodos) {
            if (da.equals(p.getDesdeFecha())) {
                comboPeriodos.setSelectedIndex(perio);
                break;
            }
            perio += 1;
        }
        fechaFacturaTxt.setText(sdf.format(comprobante.getFechaFactura()));
        if (comprobante.getEsDebito()) {
            if (comprobante.getTipoComprobante().equals("FC")) {
                facturaChk.setSelected(true);
                notaCreditoChk.setSelected(false);
                notaDebitoChk.setSelected(false);
            } else {
                facturaChk.setSelected(false);
                notaCreditoChk.setSelected(false);
                notaDebitoChk.setSelected(true);
            }
        } else {
            facturaChk.setSelected(false);
            notaCreditoChk.setSelected(true);
            notaDebitoChk.setSelected(false);
        }
        if (comprobante.getLetra() != null) {
            if (comprobante.getLetra().equals("")) {
                comboLetraFactura.setSelectedIndex(0);
            } else {
                if (comprobante.getLetra().equals("A")) {
                    comboLetraFactura.setSelectedIndex(1);
                } else {
                    if (comprobante.getLetra().equals("C")) {
                        comboLetraFactura.setSelectedIndex(2);
                    } else {
                        if (comprobante.getLetra().equals("M")) {
                            comboLetraFactura.setSelectedIndex(3);
                        } else {
                            if (comprobante.getLetra().equals("B")) {
                                comboLetraFactura.setSelectedIndex(4);
                            } else {
                                comboLetraFactura.setSelectedIndex(5);
                            }
                        }
                    }
                }
            }
        }
        nroSucursalTxt.setText(String.valueOf(comprobante.getNumeroSucursal()));
        nroFacturTxt.setText(String.valueOf(comprobante.getNumeroFactura()));
        gravadoTxt.setText(df.format(comprobante.getGravado()));
        noGravadoTxt.setText(df.format(comprobante.getNoGravado()));
        impuestoInternoTxt.setText(df.format(comprobante.getImpuestoInterno()));
        percepcionIIBBTxt.setText(df.format(comprobante.getPercepcionIiBb()));
        percepcionIvaTxt.setText(df.format(comprobante.getPercepcionIva()));
        otroTxt.setText(df.format(comprobante.getOtro()));
        ivaTxt.setText(df.format(comprobante.getIva()));
        totalTxt.setText(df.format(comprobante.getTotal()));
        gravadoTxt.setEditable(false);
        noGravadoTxt.setEditable(false);
        impuestoInternoTxt.setEditable(false);
        percepcionIIBBTxt.setEditable(false);
        percepcionIvaTxt.setEditable(false);
        otroTxt.setEditable(false);
        ivaTxt.setEditable(false);
        totalTxt.setEditable(false);
        if (comprobante.getTieneDetalle()) {
            llevaDetalleChk.setSelected(true);
            List<ComprobanteComprasDetalle> ccd = null;
            try {
                ccd = new ComprobanteComprasDetalleService().getDetalleByComprobante(comprobante);
            } catch (Exception ex) {
                Logger.getLogger(VerComprobanteComprasFrame.class.getName()).log(Level.SEVERE, null, ex);
            }
            if (ccd != null) {
                detalle1Txt.setText("");
                detalle2Txt.setText("");
                detalle3Txt.setText("");
                detalle4Txt.setText("");
                int y = 0;
                for (ComprobanteComprasDetalle cc : ccd) {
                    int i = cc.getOrden();
                    if (i == 0) {
                        detalle1Txt.setText(ccd.get(y).getTexto());
                    }
                    if (i == 1) {
                        detalle2Txt.setText(ccd.get(y).getTexto());
                    }
                    if (i == 2) {
                        detalle3Txt.setText(ccd.get(y).getTexto());
                    }
                    if (i == 3) {
                        detalle4Txt.setText(ccd.get(y).getTexto());
                    }
                    y += 1;
                }
            }
            comboLetraFactura.setEnabled(false);
            facturaChk.setEnabled(false);
            notaDebitoChk.setEnabled(false);
        } else {
            llevaDetalleChk.setSelected(false);
        }
        llevaDetalleChk.setEnabled(false);
        detalle1Txt.setEditable(false);
        detalle2Txt.setEditable(false);
        detalle3Txt.setEditable(false);
        detalle4Txt.setEditable(false);
    }

    private void impresion() {
        if (llevaDetalleChk.isSelected()) {
            PrinterJob pj = PrinterJob.getPrinterJob();
            PageFormat pf = pj.defaultPage();
            Paper paper = new Paper();
            double margin = 8;
            paper.setImageableArea(margin, margin, paper.getWidth() - margin * 2, paper.getHeight() - margin * 2);
            pf.setPaper(paper);
            pj.setPrintable(new MyPrintable(), pf);
//        if (pj.printDialog()) {
            try {
                pj.print();
            } catch (PrinterException e) {
                System.out.println(e);
            }
        }
    }

    class MyPrintable implements Printable {

        public int print(Graphics g, PageFormat pf, int pageIndex) {
            if (pageIndex != 0) {
                return NO_SUCH_PAGE;
            }
            Graphics2D g2 = (Graphics2D) g;
            g2.setFont(new Font("Monospaced", Font.PLAIN, 8));
            g2.setPaint(Color.black);
            int row = 45;
            //                1234567890123456789012345678901234567890123456789012345678901234567890
            g2.setFont(new Font("Monospaced", Font.PLAIN, 14));
            String espacio = "                              ";
            g2.drawString(espacio + "X", 30, row);
            g2.setFont(new Font("Monospaced", Font.PLAIN, 8));
            g2.setFont(new Font("Monospaced", Font.PLAIN, 8));
            g2.drawString("DISTRIBUIDORA A Y M", 50, row);
            row += 20;
            g2.drawString("COMPROBANTE DEVOLUCION", 50, row);
            row += 30;
            g2.drawString(proveedorSeleccionado.getRazonSocial(), 50, row);
            row += 30;
            String nf = comboLetraFactura.getSelectedItem().toString() + " " + nroSucursalTxt.getText() + "-" + nroFacturTxt.getText();
            g2.drawString("NÃºmero Comprobante: " + nf, 50, row);
            row += 20;
            g2.drawString("Fecha Comprobante: " + fechaFacturaTxt.getText(), 50, row);
            row += 45;
            g2.drawString(detalle1Txt.getText(), 50, row);
            row += 15;
            g2.drawString(detalle2Txt.getText(), 50, row);
            row += 15;
            g2.drawString(detalle3Txt.getText(), 50, row);
            row += 15;
            g2.drawString(detalle4Txt.getText(), 50, row);
            g2.drawString(totalTxt.getText(), 500, row);
            row += 25;
            g2.drawString("FIRMA:", 50, row);
            row += 25;
            g2.drawString("ACLARACION:", 50, row);
            row += 25;
            g2.drawString("DOCUMENTO:", 50, row);
            row = 455;
            g2.setFont(new Font("Monospaced", Font.PLAIN, 14));
            g2.drawString(espacio + "X", 30, row);
            g2.setFont(new Font("Monospaced", Font.PLAIN, 8));
            g2.drawString("DISTRIBUIDORA A Y M", 50, row);
            row += 20;
            g2.drawString("COMPROBANTE DEVOLUCION", 50, row);
            row += 30;
            g2.drawString(proveedorSeleccionado.getRazonSocial(), 50, row);
            row += 30;
            g2.drawString("NÃºmero Comprobante: " + nf, 50, row);
            row += 20;
            g2.drawString("Fecha Comprobante: " + fechaFacturaTxt.getText(), 50, row);
            row += 45;
            g2.drawString(detalle1Txt.getText(), 50, row);
            row += 15;
            g2.drawString(detalle2Txt.getText(), 50, row);
            row += 15;
            g2.drawString(detalle3Txt.getText(), 50, row);
            row += 15;
            g2.drawString(detalle4Txt.getText(), 50, row);
            g2.drawString(totalTxt.getText(), 500, row);
            row += 25;
            g2.drawString("FIRMA:", 50, row);
            row += 25;
            g2.drawString("ACLARACION:", 50, row);
            row += 25;
            g2.drawString("DOCUMENTO:", 50, row);
            return PAGE_EXISTS;
        }
    }
}
